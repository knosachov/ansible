# setup-lb.yml
---
  - hosts: loadbalancers
    tasks:
       - name: Enabling a2enmod proxy module
         shell: | 
                a2enmod proxy
                a2enmod proxy_balancer
                a2enmod proxy_http
                a2enmod lbmethod_byrequests

       - name: Creating a template
         template:
            src  : ./configs/lb-config.j2
            dest : /etc/apache2/conf-enabled/lb.conf
            owner: root 
            group: root
            mode : 064
         notify: restart apache
       
    handlers:
       - name: restart apache
         service: 
            name : apache2 
            state: restarted
